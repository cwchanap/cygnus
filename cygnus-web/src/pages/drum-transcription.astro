---
import MainLayout from '@/layouts/main.astro';
import DrumFileUpload from '../components/DrumFileUpload.svelte';
import DrumJobsList from '../components/DrumJobsList.svelte';
---

<MainLayout content={{ title: 'Drum Transcription - Cygnus' }}>
  <div class="container mx-auto px-6 py-8">
    <div class="bg-white/10 backdrop-blur-lg rounded-3xl shadow-2xl max-w-4xl w-full p-10 border border-white/20 mx-auto">
      <header class="text-center mb-10">
        <h1 class="text-4xl font-bold text-white mb-2 drop-shadow-lg">
          ü•Å Drum Transcription
        </h1>
        <p class="text-white text-lg drop-shadow-md">
          Upload your drum audio and get MIDI transcription powered by AI
        </p>
        <div class="mt-4 p-4 bg-blue-500/20 border border-blue-300/30 rounded-lg backdrop-blur-sm">
          <p class="text-sm text-white drop-shadow-sm">
            ‚öôÔ∏è You can run transcription in two ways:
          </p>
          <ul class="list-disc list-inside text-xs text-white/90 mt-2 space-y-1">
            <li>
              In-browser (TFJS): No server required. Click "Transcribe in Browser (TFJS)" after uploading.
              Optionally set <code class="font-mono">PUBLIC_TFJS_MODEL_URL</code> to a TFJS model. Falls back to signal processing if missing.
            </li>
            <li>
              Python server: For the cygnus-api flow, ensure the server is running on port 8000.
            </li>
          </ul>
          <code class="text-xs text-white font-mono block mt-2 bg-blue-600/30 px-3 py-1 rounded">
            cd ~/workspace/cygnus/cygnus-api && uv run uvicorn app.main:app --reload --port 8000
          </code>
        </div>
      </header>

      <div class="space-y-8">
        <DrumFileUpload client:load />

        <div class="border-t border-white/20 pt-8">
          <DrumJobsList client:load />
        </div>
      </div>
    </div>
  </div>
</MainLayout>
